{"version":3,"file":"MessageHandler.js","names":["sap","ui","define","ManagedObject","__Util","Fragment","JSONModel","sap_ui_core_library","Log","___enums","XLSX","_interopRequireDefault","obj","__esModule","default","Util","MessageType","CustomMessageTypes","MessageHandler","extend","constructor","_constructor","spreadsheetUploadController","prototype","call","this","messages","setMessages","_setMessages","addArrayToMessages","_addArrayToMessages","debug","undefined","component","logger","returnObject","concat","addMessageToMessages","_addMessageToMessages","message","push","getMessages","_getMessages","checkDuplicateColumns","_checkDuplicateColumns","columnNames","duplicateColumns","filter","columnName","index","indexOf","length","errorMessage","title","util","geti18nText","join","type","DuplicateColumns","ui5type","Error","group","checkMandatoryColumns","_checkMandatoryColumns","data","mandatoryFieldsUser","mandatoryFieldsMetadata","typeLabelList","mandatoryFields","Set","checkMandatoryFields","_checkMandatoryFields","mandatoryField","fieldLabel","get","label","error","row","entries","value","getValueFromRow","getFieldMatchType","MandatoryFieldNotFilled","counter","rawValue","checkFormat","_checkFormat","Object","values","forEach","_ref","sheetDataType","format","formattedValue","Number","warningMessage","Formatting","Warning","checkMaxLength","_checkMaxLength","fieldMatchType","key","valueTypeLabelList","maxLength","exceededLength","MaxLengthExceeded","excededLength","checkColumnNames","_checkColumnNames","found","includes","ColumnNotFound","checkKeyColumns","_checkKeyColumns","odataKeyList","availableKeyColumns","columnNameLabel","areMessagesPresent","_areMessagesPresent","some","displayMessages","async","_displayMessages","strict","messageDialog","load","name","controller","setModel","componentI18n","messagesGrouped","groupMessages","sortedMessagesGrouped","sortMessagesByTitle","getModel","setData","dialogState","getWorstType","infoModel","getStrict","strictParameter","open","_groupMessages","counterLargerThanOne","parsingMessages","messageGroups","reduce","groups","messageText","description","groupedMessages","messageKeyTitle","messageArray","find","map","details","allMessages","onCloseMessageDialog","_onCloseMessageDialog","close","destroy","resetContent","onContinue","_onContinue","spreadsheetUploadDialog","getSpreadsheetUploadDialog","payloadArrayLength","payloadArray","setProperty","onDownloadErrors","_onDownloadErrors","getData","headerMapping","rowNumber","colWidth","wch","flattenedData","item","detail","transformedItem","hasOwnProperty","worksheet","utils","json_to_sheet","workbook","book_new","book_append_sheet","writeFile","_sortMessagesByTitle","sort","a","b","_getWorstType","worstType","None","severity","Information","Success"],"sources":["MessageHandler-dbg.js"],"mappings":"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","ignoreList":[]}