"use strict";sap.ui.define(["sap/ui/base/ManagedObject","sap/m/Button","sap/m/Column","sap/m/ColumnListItem","sap/m/Dialog","sap/m/Table","sap/ui/model/json/JSONModel","sap/m/Text","./Util"],function(e,t,n,s,o,i,a,r,l){"use strict";function c(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const u=c(l);const d=e.extend("cc.spreadsheetimporter.v1_1_1.Preview",{constructor:function t(n){e.prototype.constructor.call(this);this.util=n},showPreview:function e(n,s,i){const a=this.createDynamicTable(n,s,i);if(typeof a==="undefined"){return}this.dialog=new o({title:this.util.geti18nText("spreadsheetimporter.previewTableName"),content:[a],buttons:[new t({text:this.util.geti18nText("spreadsheetimporter.messageDialogButtonClose"),press:()=>{this.dialog.close()}})],afterClose:()=>{this.dialog.destroy()}});this.dialog.open()},createDynamicTable:function e(t,o,l){const c=new i;if(typeof t!=="undefined"&&t!==null&&t.length>0){const e=t[0];const i=Object.keys(e);i.forEach(e=>{if(l&&l.length>0&&l.indexOf(e)===-1){return}const t=o.get(e);const s=t&&t.label?t.label:e;const i=new n({header:new r({text:s})});c.addColumn(i)});const u=new s;i.forEach(t=>{let n;if(typeof e[t]==="object"&&e[t]instanceof Date){n=new r({text:`{path: '${t}', type: 'sap.ui.model.type.Date'}`})}else{n=new r({text:"{"+t+"}"})}u.addCell(n)});const d=new a;d.setData(t);c.setModel(d);c.bindItems({path:"/",template:u});return c}else{u.showError(new Error(this.util.geti18nText("spreadsheetimporter.noDataPreview")),"Preview.ts","createDynamicTable");return undefined}}});return d});
//# sourceMappingURL=Preview.js.map